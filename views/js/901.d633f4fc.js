"use strict";(self["webpackChunkwxcli"]=self["webpackChunkwxcli"]||[]).push([[901],{2901:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"maindata"},[a("Backtop"),a("div",{staticClass:"head"},[e._m(0),a("div",{staticClass:"headRight"},[a("van-image",{attrs:{round:"",width:"60px",height:"60px",src:e.userInfo.avatarurl}}),a("UpLoaderOne",{on:{getfile:e.getphoto}})],1)]),a("div",{staticClass:"input"},[a("van-cell-group",[a("van-field",{attrs:{label:"昵称",placeholder:e.userInfo.nickname},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}})],1),a("van-cell-group",[a("van-field",{attrs:{readonly:"",clickable:"",name:"datetimePicker",value:e.gender,label:"性别",placeholder:e.userInfo.gender},on:{click:function(t){e.showPicker=!0}}}),a("van-popup",{attrs:{position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[a("van-picker",{attrs:{"show-toolbar":"",columns:e.columns},on:{confirm:e.onConfirmSex,cancel:function(t){e.showPicker=!1}}})],1)],1),a("van-cell-group",[a("van-field",{attrs:{readonly:"",clickable:"",name:"datetimePicker",value:e.birthday,label:"时间选择",placeholder:e.userInfo.birthday},on:{click:function(t){e.showDate=!0}}}),a("van-popup",{attrs:{position:"bottom"},model:{value:e.showDate,callback:function(t){e.showDate=t},expression:"showDate"}},[a("van-datetime-picker",{attrs:{type:"date","min-date":e.minDate,"max-date":e.maxDate},on:{confirm:e.onConfirmDate,cancel:function(t){e.showDate=!1}},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1)],1),a("SelectSite",{attrs:{address:e.userInfo.address},on:{updateAddress:e.getaddress}})],1),a("div",{staticClass:"footer"},[a("van-button",{staticClass:"btn",attrs:{round:"",type:"info"},on:{click:e.clearinfo}},[e._v("取消")]),a("van-button",{staticClass:"btn",attrs:{round:"",type:"info"},on:{click:e.saveData}},[e._v("保存")])],1)],1)},s=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"headLeft"},[a("b",[e._v("头像")])])}],r=(a(8508),a(8256)),i=a(4665),o={name:"MainData",mounted(){this.getUserInfo()},data(){return{showDate:!1,minDate:new Date(1900,0,1),maxDate:new Date,currentDate:new Date(2001,0,1),tipsMsg:"保存成功",avatar:[],columns:["男","女"],showPicker:!1,birthday:null,nickname:null,address:null,gender:null}},methods:{async getUserInfo(){try{await this.$store.dispatch("user/getUserInfo")}catch(e){(0,r.Z)("获取用户信息失败")}},async saveData(){let e={nickname:this.nickname,address:this.address,gender:this.gender,birthday:this.birthday};try{let t=await this.$store.dispatch("user/updateInfo",e);await(0,r.Z)(t),location.reload()}catch(t){(0,r.Z)(t)}},getaddress(e){this.address=e},onClickLeft(){(0,r.Z)("返回")},formatDate(e){return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}`},onConfirmDate(e){this.showDate=!1,this.birthday=this.formatDate(e)},async getphoto(e){let t=new FormData;console.log(e),t.append("avatarurl",e[0].file);try{let e=await this.$store.dispatch("user/updateUserAvatar",t);await(0,r.Z)(e),location.reload()}catch(a){(0,r.Z)(a)}},clearinfo(){},onConfirmSex(e){this.gender=e,this.showPicker=!1}},computed:{...(0,i.rn)("user",["userInfo"])}},c=o,l=a(3736),d=(0,l.Z)(c,n,s,!1,null,"9afa120a",null),u=d.exports}}]);